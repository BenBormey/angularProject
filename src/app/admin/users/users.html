<p>users works!</p>
<div class="users-container">
  <div class="header">
    <h2>User Management</h2>
    <div>
      <button class="load-btn" (click)="loadinguser()">Reload Users</button>
      <button class="add-btn" (click)="showAddModal = true">+ Add New User</button>
    </div>
  </div>

  <table *ngIf="users.length > 0">
    <thead>
      <tr>
        <th>ID</th>
        <th>Full Name</th>
        <th>Email</th>
        <th>Phone</th>
        <th>Role</th>
        <th>Branch</th>
        <th>Status</th>
        <th>Action</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let u of users">
        <td>{{ u.userId }}</td>
        <td>{{ u.fullName }}</td>
        <td>{{ u.email }}</td>
        <td>{{ u.phone }}</td>
        <td>{{ u.role }}</td>
        <td>{{ u.branchName }}</td>
        <td>
          <span [class.active]="u.isActive" [class.inactive]="!u.isActive">
            {{ u.isActive ? 'Active' : 'Inactive' }}
          </span>
        </td>
        <td>
          <button class="action-btn edit" (click)="openEditModal(u)">
            Edit
          </button>
          <button class="action-btn" (click)="selectUser(u.userId)">
            Change Password
          </button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- ============ ADD USER MODAL ============ -->
  <div class="modal-backdrop" *ngIf="showAddModal">
    <div class="modal">
      <h3>Add New User</h3>

      <div class="form-group">
        <label>Full Name</label>
        <input type="text" [(ngModel)]="newUser.fullName" />
      </div>

      <div class="form-group">
        <label>Email</label>
        <input type="email" [(ngModel)]="newUser.email" />
      </div>

      <div class="form-group">
        <label>Phone</label>
        <input type="text" [(ngModel)]="newUser.phone" />
      </div>

      <div class="form-group">
        <label>Branch ID</label>
        <input type="number" [(ngModel)]="newUser.branchId" />
      </div>

      <div class="form-group">
        <label>Role</label>
        <select [(ngModel)]="newUser.role">
          <option value="User">User</option>
          <option value="Admin">Admin</option>
        </select>
      </div>

      <div class="form-group">
        <label>Password</label>
        <input type="password" [(ngModel)]="newUser.password" />
      </div>

      <div class="modal-actions">
        <button class="cancel-btn" (click)="showAddModal = false">
          Cancel
        </button>
        <button class="save-btn" (click)="addUser()">Save</button>
      </div>
    </div>
  </div>

  <!-- ============ EDIT USER MODAL ============ -->
  <div class="modal-backdrop" *ngIf="showEditModal">
    <div class="modal">
      <h3>Edit User</h3>

      <div class="form-group">
        <label>Full Name</label>
        <input type="text" [(ngModel)]="editUser.fullName" />
      </div>

      <div class="form-group">
        <label>Email</label>
        <input type="email" [(ngModel)]="editUser.email" />
      </div>

      <div class="form-group">
        <label>Phone</label>
        <input type="text" [(ngModel)]="editUser.phone" />
      </div>

      <div class="form-group">
        <label>Branch ID</label>
        <input type="number" [(ngModel)]="editUser.branchId" />
      </div>

      <div class="form-group">
        <label>Role</label>
        <select [(ngModel)]="editUser.role">
          <option value="User">User</option>
          <option value="Admin">Admin</option>
        </select>
      </div>

      <div class="form-group">
        <label>Password</label>
        <input type="password" [(ngModel)]="editUser.password" />
      </div>

      <div class="modal-actions">
        <button class="cancel-btn" (click)="showEditModal = false">
          Cancel
        </button>
        <button class="save-btn" (click)="updateUser()">Update</button>
      </div>
    </div>
  </div>

  <!-- ============ CHANGE PASSWORD ============ -->
  <div class="change-password-card" *ngIf="changePasswordModel.userId !== 0">
    <h3>Change Password (User ID: {{ changePasswordModel.userId }})</h3>

    <div class="form-group">
      <label>Current Password</label>
      <input
        type="password"
        [(ngModel)]="changePasswordModel.currentPassword"
      />
    </div>

    <div class="form-group">
      <label>New Password</label>
      <input type="password" [(ngModel)]="changePasswordModel.newPassword" />
    </div>

    <div class="form-group">
      <label>Confirm New Password</label>
      <input
        type="password"
        [(ngModel)]="changePasswordModel.confirmNewPassword"
      />
    </div>

    <button class="save-btn" (click)="changePassword()">
      Save New Password
    </button>
  </div>
</div>
