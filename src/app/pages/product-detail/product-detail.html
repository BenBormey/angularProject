<div *ngIf="loading" class="loading">
  Loading product...
</div>

<div *ngIf="!loading && product" class="detail-container">
  <div class="product-card">

    <!-- LEFT: IMAGE -->
    <div class="gallery">
      <img class="main-image" [src]="selectedImage" alt="Product" />

      <div class="thumbs">
        <img
          *ngFor="let img of selectedVariant?.images"
          [src]="img"
          alt="thumb"
          (click)="selectImage(img)"
          [class.active]="img === selectedImage"
        />
      </div>
    </div>

    <!-- RIGHT: INFO -->
    <div class="info">
      <h2 class="title">{{ product.productName }}</h2>
      <p class="category">{{ product.categoryName }}</p>
      <p class="description">{{ product.description }}</p>

      <!-- PRICE -->
      <div class="price-section">
        <p class="original-price" *ngIf="discountAmount > 0">
          ${{ selectedVariant?.price }}
        </p>

        <p class="discount" *ngIf="discountAmount > 0">
          - ${{ discountAmount.toFixed(2) }}
        </p>

        <p class="tax" *ngIf="taxAmount > 0">
          + ${{ taxAmount.toFixed(2) }}
        </p>

        <h3 class="final-price">
          ${{ finalPrice.toFixed(2) }}
        </h3>
      </div>

      <p class="stock">Stock: {{ selectedVariant?.stock }}</p>

      <!-- DISCOUNTS -->
      <div class="meta" *ngIf="product.discounts?.length">
        <strong>Discounts:</strong>
        <ul>
          <li *ngFor="let d of product.discounts">
            {{ d.discountName }} ({{ d.discountType }} - {{ d.discountValue }})
            <span [class.inactive]="!d.isActive">
              {{ d.isActive ? 'Active' : 'Inactive' }}
            </span>
          </li>
        </ul>
      </div>

      <!-- TAXES -->
      <div class="meta" *ngIf="product.taxes?.length">
        <strong>Taxes:</strong>
        <ul>
          <li *ngFor="let t of product.taxes">
            {{ t.taxName }} ({{ t.taxRate }}%)
            <span [class.inactive]="!t.isActive">
              {{ t.isActive ? 'Active' : 'Inactive' }}
            </span>
          </li>
        </ul>
      </div>

      <!-- COLOR -->
      <div class="option-group">
        <label>Color</label>
        <div class="options">
          <button
            *ngFor="let v of product.variants"
            (click)="selectVariant(v)"
            [class.active]="v.variantId === selectedVariant?.variantId"
          >
            {{ v.color }}
          </button>
        </div>
      </div>

      <!-- SIZE -->
      <div class="option-group">
        <label>Size</label>
        <div class="size-box">{{ selectedVariant?.size }}</div>
      </div>

      <button class="add-to-cart">Add to Cart</button>
    </div>

  </div>
</div>
